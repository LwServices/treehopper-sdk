\page pins Pins

Each Treehopper pin functions can read and output digital values, as well as read analog voltages.

# Pin Mode
You can choose whether a pin should be a digital input, output, or analog input by setting the pin's mode property. Consult the API documentation for the language you're using to determine how to set the pin mode.

# Digital outputs
All pins on Treehopper support both push-pull and open-drain outputs. Writing a true or false to the pin's digital value will flush that value to the pin.

 - **Push-Pull**: Push-pull is the commonly used output mode; when a pin is set to true, Treehopper will attempt to drive the pin to logic HIGH (3.3V) — when a pin is set to false, Treehopper will attempt to drive the pin to logic LOW (0V — also referred to as ground).
 - **Open-Drain**: Open-drain outputs can only drive a strong logic LOW (0V); in the other state, the pin is allowed to float.

## Output Current Limitations
Treehopper can source approximately 20 mA of current out of each pin when short-circuited. 

Treehopper can sink approximately 40 mA of current into each pin when short-circuited. 

While this is plenty of current for peripheral ICs and small indicator LEDs, do not expect to drive large arrays of LEDs, or low-impedance loads like motors, solenoids, or speakers directly from Treehopper's pins. There are a wide variety of peripherals in the Treehopper.Libraries package for your language API that can be used for interfacing with these peripherals.

\warning **To avoid damaging the device permanently, do not source or sink more than 400 mA of combined current out of the pins on the board!** Note that these limits have nothing to do with the supply pins found on Treehopper; you can comfortably source 500 mA out of either the 5V or 3.3V supply pins on the board.

# Digital input {#pins_digitalin}
Treehopper's digital inputs are used to sample digital signals — i.e., signals that have either a <i>LOW</i> or <i>HIGH</i> state. A <i>LOW</i> is considered a voltage less than or equal to 0.6V. Logic <b>HIGH</b> is considered a voltage greater than or equal to 2.7V.

Treehopper pins are 5V-tolerant; note that this means there is a 5V-capable protection diode shunting to VDD (3.3V) -- it does not mean you can drive a low-impedance (strong) 5V signal into a pin; if you have 5V outputs from peripherals or other devices that you wish to use, please place a resistor in series with the signal to limit current:
![Use a series resistor between 5V outputs and Treehopper input pins to limit current](images/pins-current-limiting.svg)

\warning **Do not exceed 5.8V on any pin at any time or you will permanently damage the board.**

Treehopper digital pins are sampled continuously onboard; when any pin changes, this data is sent to the host device. 

# Analog inputs
Unlike many embedded platforms, each Treehopper pin can be read using the on-board 12-bit ADC. There is no limit to the total number of analog pins activated at any time. 

## Output Format
When the pin is sampled and sent to the host, the value is simultaneously available to the user in three forms:
 - **AdcValue** -- the raw, 12-bit result from conversion.
 - **AnalogValue** -- the normalized value of the ADC (from 0-1).
 - **AnalogVoltage** -- the actual voltage at the pin (taking into account the reference level).

## Reference Levels
Each pin has a configurable reference level that can be used to measure the pin against. The reference levels are:
 - 3.3V generated by the on-board LDO, rated at 1.5% accuracy (default).
 - 3.6V (effective) reference derived from the on-chip 1.8V reference.
 - 2.4V on-chip reference rated at 2.1% accuracy.
 - 1.8V on-chip reference.
 - 1.65V on-chip reference, 1.8% accurate.
 - 3.3V (effective) reference that is derived from the on-chip 1.65V reference.

 For most ratiometric applications --- i.e., when measuring a device whose output is ratioed to its power supply --- connect the sensor's power supply to the 3.3V supply pin the Treehopper and use the default 3.3V reference. The other reference options are provided for advanced scenarios that involve reading from precision voltage outputs accurately.

# Performance Considerations
Writing values to (or changing pin modes of) Treehopper pins will flush to the OS's USB layer immediately, but there is no way of achieving guaranteed latency. 

Occasional writes (say, on the order of every 20 ms or more) will usually flush to the port within 0.1-1 ms. If your application is chatty, or the bus you're operating on has other devices (especially isochronous devices like webcams), you may see long periods (several milliseconds) of delay. 

Analog pins take a relatively long time to sample; if you enable tons of analog inputs, the effective sampling rate will drop by up to two times.
